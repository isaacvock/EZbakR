<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In SimulateOneRep, users have the option to either provide vectors of feature-specific
read counts, fraction news, kdegs, and ksyns for the simulation, or to have those drawn
from relevant distributions whose properties can be tuned by the various optional
parameters of SimulateOneRep. The number of mutable nucleotides (nT) in
a read is drawn from a binomial distribution with readlength trials and a probability
of &quot;success&quot; equal to Ucont. A read's status as new or old is drawn from a Bernoulli
distribution with probability of &quot;success&quot; equal to the feature's fraction new. If a read
is new, the number of mutations in the read is drawn from a binomial distribution with
probability of mutation equal to pnew. If a read is old, the number of mutations is instead
drawn from a binomial distribution with probability of mutation equal to pold."><title>Simulate a single replicate of NR-seq data — SimulateOneRep • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a single replicate of NR-seq data — SimulateOneRep"><meta property="og:description" content="In SimulateOneRep, users have the option to either provide vectors of feature-specific
read counts, fraction news, kdegs, and ksyns for the simulation, or to have those drawn
from relevant distributions whose properties can be tuned by the various optional
parameters of SimulateOneRep. The number of mutable nucleotides (nT) in
a read is drawn from a binomial distribution with readlength trials and a probability
of &quot;success&quot; equal to Ucont. A read's status as new or old is drawn from a Bernoulli
distribution with probability of &quot;success&quot; equal to the feature's fraction new. If a read
is new, the number of mutations in the read is drawn from a binomial distribution with
probability of mutation equal to pnew. If a read is old, the number of mutations is instead
drawn from a binomial distribution with probability of mutation equal to pold."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AverageAndRegularize.html">AverageAndRegularize</a>
    <a class="dropdown-item" href="../articles/CompareParameters.html">CompareParameters</a>
    <a class="dropdown-item" href="../articles/EstimateFractions.html">EstimateFractions</a>
    <a class="dropdown-item" href="../articles/EstimateKinetics.html">EstimateKinetics</a>
    <a class="dropdown-item" href="../articles/EZget.html">EZget</a>
    <a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a single replicate of NR-seq data</h1>
      
      <div class="d-none name"><code>SimulateOneRep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In <code>SimulateOneRep</code>, users have the option to either provide vectors of feature-specific
read counts, fraction news, kdegs, and ksyns for the simulation, or to have those drawn
from relevant distributions whose properties can be tuned by the various optional
parameters of <code>SimulateOneRep</code>. The number of mutable nucleotides (nT) in
a read is drawn from a binomial distribution with <code>readlength</code> trials and a probability
of "success" equal to <code>Ucont</code>. A read's status as new or old is drawn from a Bernoulli
distribution with probability of "success" equal to the feature's fraction new. If a read
is new, the number of mutations in the read is drawn from a binomial distribution with
probability of mutation equal to pnew. If a read is old, the number of mutations is instead
drawn from a binomial distribution with probability of mutation equal to pold.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimulateOneRep</span><span class="op">(</span></span>
<span>  <span class="va">nfeatures</span>,</span>
<span>  read_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_time <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="st">"sampleA"</span>,</span>
<span>  feature_prefix <span class="op">=</span> <span class="st">"Gene"</span>,</span>
<span>  fn_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kdeg_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ksyn_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pnew <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pold <span class="op">=</span> <span class="fl">0.002</span>,</span>
<span>  logkdeg_mean <span class="op">=</span> <span class="op">-</span><span class="fl">1.9</span>,</span>
<span>  logkdeg_sd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  logksyn_mean <span class="op">=</span> <span class="fl">2.3</span>,</span>
<span>  logksyn_sd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  seqdepth <span class="op">=</span> <span class="va">nfeatures</span> <span class="op">*</span> <span class="fl">2500</span>,</span>
<span>  readlength <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  Ucont <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  feature_pnew <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pnew_kdeg_corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  logit_pnew_mean <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span>,</span>
<span>  logit_pnew_sd <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>nfeatures</dt>
<dd><p>Number of "features" (e.g., genes) to simulate data for</p></dd>


<dt>read_vect</dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the number of reads
to be simulated for each feature. If this is not provided, the number of reads
simulated is equal to <code>round(seqdepth * (ksyn_i/kdeg_i)/sum(ksyn/kdeg))</code>. In other words,
the normalized steady-state abundance of a feature is multiplied by the total number
of reads to be simulated and rounded to the nearest integer.</p></dd>


<dt>label_time</dt>
<dd><p>Length of s^4U feed to simulate.</p></dd>


<dt>sample_name</dt>
<dd><p>Character vector to assign to <code>sample</code> column of output simulated
data table (the cB table).</p></dd>


<dt>feature_prefix</dt>
<dd><p>Name given to the i-th feature is <code>paste0(feature_prefix, i)</code>. Shows up in the
<code>feature</code> column of the output simulated data table.</p></dd>


<dt>fn_vect</dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the fraction new to use for each
feature's simulation. If this is not provided and <code>kdeg_vect</code> is, then <code>fn_vect = 1 - exp(-kdeg_vect*label_time)</code>.
If both <code>fn_vect</code> and <code>kdeg_vect</code> are not provided, then kdegs are simulated from a joint distribution as
described below and converted to a <code>fn_vect</code> as when <code>kdeg_vect</code> is user-provided.</p></dd>


<dt>kdeg_vect</dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the degradation rate constant to use for each
feature's simulation. If this is not provided and <code>fn_vect</code> is, then <code>kdeg_vect = -log(1 - fn_vect)/label_time</code>.
If both <code>kdeg_vect</code> and <code>fn_vect</code> are not provided, each feature's <code>kdeg_vect</code> value is drawn from a log-normal distrubition
with meanlog = <code>logkdeg_mean</code> and sdlog = <code>logkdeg_sd</code>. <code>kdeg_vect</code> is actually only simulated in the case
where <code>read_vect</code> is also not provided, as it will be used to simulate read counts as described above.</p></dd>


<dt>ksyn_vect</dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the synthesis rate constant to use for each
feature's simulation. If this is not provided, and <code>read_vect</code> is also not provided, then each
feature's <code>ksyn_vect</code> value is drawn from a log-normal distribution with meanlog = <code>logksyn_mean</code> and
sdlog = <code>logksyn_sd</code>. ksyn's do not need to be simulated if <code>read_vect</code> is provided, as they only
influence read counts.</p></dd>


<dt>pnew</dt>
<dd><p>Probability that a T is mutated to a C if a read is new.</p></dd>


<dt>pold</dt>
<dd><p>Probability that a T is mutated to a C if a read is old.</p></dd>


<dt>logkdeg_mean</dt>
<dd><p>If necessary, meanlog of a log-normal distribution from which
kdegs are simulated</p></dd>


<dt>logkdeg_sd</dt>
<dd><p>If necessary, sdlog of a log-normal distribution from which
kdegs are simulated</p></dd>


<dt>logksyn_mean</dt>
<dd><p>If necessary, meanlog of a log-normal distribution from which
ksyns are simulated</p></dd>


<dt>logksyn_sd</dt>
<dd><p>If necessary, sdlog of a log-normal distribution from which
ksyns are simulated</p></dd>


<dt>seqdepth</dt>
<dd><p>Only relevant if <code>read_vect</code> is not provided; in that case, this is
the total number of reads to simulate.</p></dd>


<dt>readlength</dt>
<dd><p>Length of simulated reads. In this simple simulation, all reads
are simulated as being exactly this length.</p></dd>


<dt>Ucont</dt>
<dd><p>Probability that a nucleotide in a simulated read is a U.</p></dd>


<dt>feature_pnew</dt>
<dd><p>Boolean; if TRUE, simulate a different pnew for each feature</p></dd>


<dt>pnew_kdeg_corr</dt>
<dd><p>Boolean; only relevant if <code>feature_pnew</code> is TRUE. If so, then
setting <code>pnew_kdeg_corr</code> to TRUE will ensure that higher kdeg transcripts have a higher
pnew.</p></dd>


<dt>logit_pnew_mean</dt>
<dd><p>If <code>feature_pnew</code> is TRUE, then the logit(pnew) for each feature
will be drawn from a normal distribution with this mean.</p></dd>


<dt>logit_pnew_sd</dt>
<dd><p>If <code>feature_pnew</code> is TRUE, then the logit(pnew) for each feature
will be drawn from a normal distribution with this standard deviation.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

