<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate a single replicate of NR-seq data — SimulateOneRep • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a single replicate of NR-seq data — SimulateOneRep"><meta name="description" content="In SimulateOneRep, users have the option to either provide vectors of feature-specific
read counts, fraction news, kdegs, and ksyns for the simulation, or to have those drawn
from relevant distributions whose properties can be tuned by the various optional
parameters of SimulateOneRep. The number of mutable nucleotides (nT) in
a read is drawn from a binomial distribution with readlength trials and a probability
of &quot;success&quot; equal to Ucont. A read's status as new or old is drawn from a Bernoulli
distribution with probability of &quot;success&quot; equal to the feature's fraction new. If a read
is new, the number of mutations in the read is drawn from a binomial distribution with
probability of mutation equal to pnew. If a read is old, the number of mutations is instead
drawn from a binomial distribution with probability of mutation equal to pold."><meta property="og:description" content="In SimulateOneRep, users have the option to either provide vectors of feature-specific
read counts, fraction news, kdegs, and ksyns for the simulation, or to have those drawn
from relevant distributions whose properties can be tuned by the various optional
parameters of SimulateOneRep. The number of mutable nucleotides (nT) in
a read is drawn from a binomial distribution with readlength trials and a probability
of &quot;success&quot; equal to Ucont. A read's status as new or old is drawn from a Bernoulli
distribution with probability of &quot;success&quot; equal to the feature's fraction new. If a read
is new, the number of mutations in the read is drawn from a binomial distribution with
probability of mutation equal to pnew. If a read is old, the number of mutations is instead
drawn from a binomial distribution with probability of mutation equal to pold."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">Convenient fetching of EZbakR outputs: EZget()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">Universal first step: EstimateFractions()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">Standard kinetic parameter estimation: EstimateKinetics()</a></li>
    <li><a class="dropdown-item" href="../articles/Linear-modeling.html">Linear modeling in EZbakR</a></li>
    <li><a class="dropdown-item" href="../articles/EZDynamics.html">Dynamical systems modeling in EZbakR: EZDynamics()</a></li>
    <li><a class="dropdown-item" href="../articles/EZQC.html">QCing your NR-seq data with EZbakR: EZQC()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate a single replicate of NR-seq data</h1>

      <div class="d-none name"><code>SimulateOneRep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In <code>SimulateOneRep</code>, users have the option to either provide vectors of feature-specific
read counts, fraction news, kdegs, and ksyns for the simulation, or to have those drawn
from relevant distributions whose properties can be tuned by the various optional
parameters of <code>SimulateOneRep</code>. The number of mutable nucleotides (nT) in
a read is drawn from a binomial distribution with <code>readlength</code> trials and a probability
of "success" equal to <code>Ucont</code>. A read's status as new or old is drawn from a Bernoulli
distribution with probability of "success" equal to the feature's fraction new. If a read
is new, the number of mutations in the read is drawn from a binomial distribution with
probability of mutation equal to pnew. If a read is old, the number of mutations is instead
drawn from a binomial distribution with probability of mutation equal to pold.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimulateOneRep</span><span class="op">(</span></span>
<span>  <span class="va">nfeatures</span>,</span>
<span>  read_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_time <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  sample_name <span class="op">=</span> <span class="st">"sampleA"</span>,</span>
<span>  feature_prefix <span class="op">=</span> <span class="st">"Gene"</span>,</span>
<span>  fn_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kdeg_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ksyn_vect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pnew <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pold <span class="op">=</span> <span class="fl">0.002</span>,</span>
<span>  logkdeg_mean <span class="op">=</span> <span class="op">-</span><span class="fl">1.9</span>,</span>
<span>  logkdeg_sd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  logksyn_mean <span class="op">=</span> <span class="fl">2.3</span>,</span>
<span>  logksyn_sd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  seqdepth <span class="op">=</span> <span class="va">nfeatures</span> <span class="op">*</span> <span class="fl">2500</span>,</span>
<span>  readlength <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  Ucont <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  feature_pnew <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pnew_kdeg_corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  logit_pnew_mean <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span>,</span>
<span>  logit_pnew_sd <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nfeatures">nfeatures<a class="anchor" aria-label="anchor" href="#arg-nfeatures"></a></dt>
<dd><p>Number of "features" (e.g., genes) to simulate data for</p></dd>


<dt id="arg-read-vect">read_vect<a class="anchor" aria-label="anchor" href="#arg-read-vect"></a></dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the number of reads
to be simulated for each feature. If this is not provided, the number of reads
simulated is equal to <code>round(seqdepth * (ksyn_i/kdeg_i)/sum(ksyn/kdeg))</code>. In other words,
the normalized steady-state abundance of a feature is multiplied by the total number
of reads to be simulated and rounded to the nearest integer.</p></dd>


<dt id="arg-label-time">label_time<a class="anchor" aria-label="anchor" href="#arg-label-time"></a></dt>
<dd><p>Length of s^4^U feed to simulate.</p></dd>


<dt id="arg-sample-name">sample_name<a class="anchor" aria-label="anchor" href="#arg-sample-name"></a></dt>
<dd><p>Character vector to assign to <code>sample</code> column of output simulated
data table (the cB table).</p></dd>


<dt id="arg-feature-prefix">feature_prefix<a class="anchor" aria-label="anchor" href="#arg-feature-prefix"></a></dt>
<dd><p>Name given to the i-th feature is <code>paste0(feature_prefix, i)</code>. Shows up in the
<code>feature</code> column of the output simulated data table.</p></dd>


<dt id="arg-fn-vect">fn_vect<a class="anchor" aria-label="anchor" href="#arg-fn-vect"></a></dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the fraction new to use for each
feature's simulation. If this is not provided and <code>kdeg_vect</code> is, then <code>fn_vect = 1 - exp(-kdeg_vect*label_time)</code>.
If both <code>fn_vect</code> and <code>kdeg_vect</code> are not provided, then kdegs are simulated from a joint distribution as
described below and converted to a <code>fn_vect</code> as when <code>kdeg_vect</code> is user-provided.</p></dd>


<dt id="arg-kdeg-vect">kdeg_vect<a class="anchor" aria-label="anchor" href="#arg-kdeg-vect"></a></dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the degradation rate constant to use for each
feature's simulation. If this is not provided and <code>fn_vect</code> is, then <code>kdeg_vect = -log(1 - fn_vect)/label_time</code>.
If both <code>kdeg_vect</code> and <code>fn_vect</code> are not provided, each feature's <code>kdeg_vect</code> value is drawn from a log-normal distrubition
with meanlog = <code>logkdeg_mean</code> and sdlog = <code>logkdeg_sd</code>. <code>kdeg_vect</code> is actually only simulated in the case
where <code>read_vect</code> is also not provided, as it will be used to simulate read counts as described above.</p></dd>


<dt id="arg-ksyn-vect">ksyn_vect<a class="anchor" aria-label="anchor" href="#arg-ksyn-vect"></a></dt>
<dd><p>Vector of length = <code>nfeatures</code>; specifies the synthesis rate constant to use for each
feature's simulation. If this is not provided, and <code>read_vect</code> is also not provided, then each
feature's <code>ksyn_vect</code> value is drawn from a log-normal distribution with meanlog = <code>logksyn_mean</code> and
sdlog = <code>logksyn_sd</code>. ksyn's do not need to be simulated if <code>read_vect</code> is provided, as they only
influence read counts.</p></dd>


<dt id="arg-pnew">pnew<a class="anchor" aria-label="anchor" href="#arg-pnew"></a></dt>
<dd><p>Probability that a T is mutated to a C if a read is new.</p></dd>


<dt id="arg-pold">pold<a class="anchor" aria-label="anchor" href="#arg-pold"></a></dt>
<dd><p>Probability that a T is mutated to a C if a read is old.</p></dd>


<dt id="arg-logkdeg-mean">logkdeg_mean<a class="anchor" aria-label="anchor" href="#arg-logkdeg-mean"></a></dt>
<dd><p>If necessary, meanlog of a log-normal distribution from which
kdegs are simulated</p></dd>


<dt id="arg-logkdeg-sd">logkdeg_sd<a class="anchor" aria-label="anchor" href="#arg-logkdeg-sd"></a></dt>
<dd><p>If necessary, sdlog of a log-normal distribution from which
kdegs are simulated</p></dd>


<dt id="arg-logksyn-mean">logksyn_mean<a class="anchor" aria-label="anchor" href="#arg-logksyn-mean"></a></dt>
<dd><p>If necessary, meanlog of a log-normal distribution from which
ksyns are simulated</p></dd>


<dt id="arg-logksyn-sd">logksyn_sd<a class="anchor" aria-label="anchor" href="#arg-logksyn-sd"></a></dt>
<dd><p>If necessary, sdlog of a log-normal distribution from which
ksyns are simulated</p></dd>


<dt id="arg-seqdepth">seqdepth<a class="anchor" aria-label="anchor" href="#arg-seqdepth"></a></dt>
<dd><p>Only relevant if <code>read_vect</code> is not provided; in that case, this is
the total number of reads to simulate.</p></dd>


<dt id="arg-readlength">readlength<a class="anchor" aria-label="anchor" href="#arg-readlength"></a></dt>
<dd><p>Length of simulated reads. In this simple simulation, all reads
are simulated as being exactly this length.</p></dd>


<dt id="arg-ucont">Ucont<a class="anchor" aria-label="anchor" href="#arg-ucont"></a></dt>
<dd><p>Probability that a nucleotide in a simulated read is a U.</p></dd>


<dt id="arg-feature-pnew">feature_pnew<a class="anchor" aria-label="anchor" href="#arg-feature-pnew"></a></dt>
<dd><p>Boolean; if TRUE, simulate a different pnew for each feature</p></dd>


<dt id="arg-pnew-kdeg-corr">pnew_kdeg_corr<a class="anchor" aria-label="anchor" href="#arg-pnew-kdeg-corr"></a></dt>
<dd><p>Boolean; only relevant if <code>feature_pnew</code> is TRUE. If so, then
setting <code>pnew_kdeg_corr</code> to TRUE will ensure that higher kdeg transcripts have a higher
pnew.</p></dd>


<dt id="arg-logit-pnew-mean">logit_pnew_mean<a class="anchor" aria-label="anchor" href="#arg-logit-pnew-mean"></a></dt>
<dd><p>If <code>feature_pnew</code> is TRUE, then the logit(pnew) for each feature
will be drawn from a normal distribution with this mean.</p></dd>


<dt id="arg-logit-pnew-sd">logit_pnew_sd<a class="anchor" aria-label="anchor" href="#arg-logit-pnew-sd"></a></dt>
<dd><p>If <code>feature_pnew</code> is TRUE, then the logit(pnew) for each feature
will be drawn from a normal distribution with this standard deviation.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

