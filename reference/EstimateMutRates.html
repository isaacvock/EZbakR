<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate mutation rates — EstimateMutRates • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate mutation rates — EstimateMutRates"><meta name="description" content="Two component mixture models are fit to all data to estimate global high and
low mutation rates for all samples. Estimation of these mutation rates
are regularized through the use of weakly informative priors whose parameters can
be altered using the arguments defined below."><meta property="og:description" content="Two component mixture models are fit to all data to estimate global high and
low mutation rates for all samples. Estimation of these mutation rates
are regularized through the use of weakly informative priors whose parameters can
be altered using the arguments defined below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">Convenient fetching of EZbakR outputs: EZget()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">Universal first step: EstimateFractions()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">Standard kinetic parameter estimation: EstimateKinetics()</a></li>
    <li><a class="dropdown-item" href="../articles/Linear-modeling.html">Linear modeling in EZbakR</a></li>
    <li><a class="dropdown-item" href="../articles/EZDynamics.html">Dynamical systems modeling in EZbakR: EZDynamics()</a></li>
    <li><a class="dropdown-item" href="../articles/EZQC.html">QCing your NR-seq data with EZbakR: EZQC()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate mutation rates</h1>

      <div class="d-none name"><code>EstimateMutRates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Two component mixture models are fit to all data to estimate global high and
low mutation rates for all samples. Estimation of these mutation rates
are regularized through the use of weakly informative priors whose parameters can
be altered using the arguments defined below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EstimateMutRates</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  populations <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  pnew_prior_mean <span class="op">=</span> <span class="op">-</span><span class="fl">2.94</span>,</span>
<span>  pnew_prior_sd <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  pold_prior_mean <span class="op">=</span> <span class="op">-</span><span class="fl">6.5</span>,</span>
<span>  pold_prior_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pold_est <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pold_from_nolabel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  grouping_factors <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An <code>EZbakRData</code> or <code>EZbakRArrowData</code> object</p></dd>


<dt id="arg-populations">populations<a class="anchor" aria-label="anchor" href="#arg-populations"></a></dt>
<dd><p>Character vector of the set of mutational populations
that you want to infer the fractions of. For example, say your cB file contains
columns tracking T-to-C and G-to-A</p></dd>


<dt id="arg-pnew-prior-mean">pnew_prior_mean<a class="anchor" aria-label="anchor" href="#arg-pnew-prior-mean"></a></dt>
<dd><p>logit-Normal mean for logit(pnew) prior.</p></dd>


<dt id="arg-pnew-prior-sd">pnew_prior_sd<a class="anchor" aria-label="anchor" href="#arg-pnew-prior-sd"></a></dt>
<dd><p>logit-Normal sd for logit(pnew) prior.</p></dd>


<dt id="arg-pold-prior-mean">pold_prior_mean<a class="anchor" aria-label="anchor" href="#arg-pold-prior-mean"></a></dt>
<dd><p>logit-Normal mean for logit(pold) prior.</p></dd>


<dt id="arg-pold-prior-sd">pold_prior_sd<a class="anchor" aria-label="anchor" href="#arg-pold-prior-sd"></a></dt>
<dd><p>logit-Normal sd for logit(pold) prior.</p></dd>


<dt id="arg-pold-est">pold_est<a class="anchor" aria-label="anchor" href="#arg-pold-est"></a></dt>
<dd><p>Background mutation rate estimates if you have them. Can either be a single
number applied to all samples or a named vector of values, where the names should be sample
names.</p></dd>


<dt id="arg-pold-from-nolabel">pold_from_nolabel<a class="anchor" aria-label="anchor" href="#arg-pold-from-nolabel"></a></dt>
<dd><p>Fix background mutation rate estimate to mutation rates seen in -label samples.
By default, a single background rate is used for all samples, inferred from the average mutation rate
across all -label samples. The <code>grouping_factors</code> argument can be specified to use certain -label samples
to infer background mutation rates for certain sets of +label samples.</p></dd>


<dt id="arg-grouping-factors">grouping_factors<a class="anchor" aria-label="anchor" href="#arg-grouping-factors"></a></dt>
<dd><p>If <code>pold_from_nolabel</code> is TRUE, then <code>grouping_factors</code> will specify the
sample-detail columns in the metadf that should be used to group -label samples by. Average mutation
rates in each group of -label samples will be used as the background mutation rate estimate in
+label samples with the same values for the relevant metadf columns.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate data to analyze</span></span></span>
<span class="r-in"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="SimulateOneRep.html">SimulateOneRep</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create EZbakR input</span></span></span>
<span class="r-in"><span><span class="va">metadf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="st">"sampleA"</span>, tl <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="EZbakRData.html">EZbakRData</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">$</span><span class="va">cB</span>, <span class="va">metadf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate mutation rates</span></span></span>
<span class="r-in"><span><span class="va">mutrates</span> <span class="op">&lt;-</span> <span class="fu">EstimateMutRates</span><span class="op">(</span><span class="va">ezbdo</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

