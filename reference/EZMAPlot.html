<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Make an MAPlot from EZbakR comparison — EZMAPlot • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make an MAPlot from EZbakR comparison — EZMAPlot"><meta name="description" content="Make a plot of effect size (y-axis) vs. log10(read coverage) (x-axis),
coloring points by position relative to user-defined decision cutoffs."><meta property="og:description" content="Make a plot of effect size (y-axis) vs. log10(read coverage) (x-axis),
coloring points by position relative to user-defined decision cutoffs."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">Convenient fetching of EZbakR outputs: EZget()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">Universal first step: EstimateFractions()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">Standard kinetic parameter estimation: EstimateKinetics()</a></li>
    <li><a class="dropdown-item" href="../articles/Linear-modeling.html">Linear modeling in EZbakR</a></li>
    <li><a class="dropdown-item" href="../articles/EZDynamics.html">Dynamical systems modeling in EZbakR: EZDynamics()</a></li>
    <li><a class="dropdown-item" href="../articles/EZQC.html">QCing your NR-seq data with EZbakR: EZQC()</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/isaacvock/EZbakR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Make an MAPlot from EZbakR comparison</h1>
      <small class="dont-index">Source: <a href="https://github.com/isaacvock/EZbakR/blob/main/R/Visualizations.R" class="external-link"><code>R/Visualizations.R</code></a></small>
      <div class="d-none name"><code>EZMAPlot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Make a plot of effect size (y-axis) vs. log10(read coverage) (x-axis),
coloring points by position relative to user-defined decision cutoffs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EZMAPlot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  parameter <span class="op">=</span> <span class="st">"log_kdeg"</span>,</span>
<span>  design_factor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reference <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  experimental <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  param_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  param_function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  condition <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repeatID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exactMatch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotlog2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  FDR_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  difference_cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  features_to_highlight <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  highlight_shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  highlight_size_diff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  highlight_stroke <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  highlight_fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  highlight_color <span class="op">=</span> <span class="st">"black"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An object of class <code>EZbakRCompare</code>, which is an <code>EZbakRData</code> object
on which you have run <code>CompareParameters</code></p></dd>


<dt id="arg-parameter">parameter<a class="anchor" aria-label="anchor" href="#arg-parameter"></a></dt>
<dd><p>Name of parameter whose comparison you want to plot.</p></dd>


<dt id="arg-design-factor">design_factor<a class="anchor" aria-label="anchor" href="#arg-design-factor"></a></dt>
<dd><p>Name of factor from <code>metadf</code> whose parameter estimates at
different factor values you would like to compare.</p></dd>


<dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>Name of reference <code>condition</code> factor level value.</p></dd>


<dt id="arg-experimental">experimental<a class="anchor" aria-label="anchor" href="#arg-experimental"></a></dt>
<dd><p>Name of <code>condition</code> factor level value to compare to reference.</p></dd>


<dt id="arg-param-name">param_name<a class="anchor" aria-label="anchor" href="#arg-param-name"></a></dt>
<dd><p>If you want to assess the significance of a single parameter,
rather than the comparison of two parameters, specify that one parameter's name
here.</p></dd>


<dt id="arg-param-function">param_function<a class="anchor" aria-label="anchor" href="#arg-param-function"></a></dt>
<dd><p>NOT YET IMPLEMENTED. Will allow you to specify more complicated
functions of parameters when hypotheses you need to test are combinations of parameters
rather than individual parameters or simple differences in two parameters.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>Character vector of feature names for which comparisons were made.</p></dd>


<dt id="arg-condition">condition<a class="anchor" aria-label="anchor" href="#arg-condition"></a></dt>
<dd><p>Defunct parameter that has been replaced with <code>design_factor</code>. If provided
gets passed to <code>design_factor</code> if <code>design_factor</code> is not already specified.</p></dd>


<dt id="arg-repeatid">repeatID<a class="anchor" aria-label="anchor" href="#arg-repeatid"></a></dt>
<dd><p>If multiple <code>kinetics</code> or <code>fractions</code> tables exist with the same metadata,
then this is the numerical index by which they are distinguished.</p></dd>


<dt id="arg-exactmatch">exactMatch<a class="anchor" aria-label="anchor" href="#arg-exactmatch"></a></dt>
<dd><p>If TRUE, then <code>features</code> and <code>populations</code> have to exactly match
those for a given fractions table for that table to be used. Means that you can't
specify a subset of features or populations by default, since this is TRUE
by default.</p></dd>


<dt id="arg-plotlog-">plotlog2<a class="anchor" aria-label="anchor" href="#arg-plotlog-"></a></dt>
<dd><p>If TRUE, assume that log(parameter) difference is passed in and that
you want to plot log2(parameter) difference.</p></dd>


<dt id="arg-fdr-cutoff">FDR_cutoff<a class="anchor" aria-label="anchor" href="#arg-fdr-cutoff"></a></dt>
<dd><p>False discovery cutoff by which to color points.</p></dd>


<dt id="arg-difference-cutoff">difference_cutoff<a class="anchor" aria-label="anchor" href="#arg-difference-cutoff"></a></dt>
<dd><p>Minimum absolute difference cutoff by which to color points.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>Size of points, passed to <code>geom_point()</code> size parameter. If not specified,
a point size is automatically chosen.</p></dd>


<dt id="arg-features-to-highlight">features_to_highlight<a class="anchor" aria-label="anchor" href="#arg-features-to-highlight"></a></dt>
<dd><p>Features you want to highlight in the plot (black circle
will be drawn around them). This can either be a data frame with one column per
feature type in the comparison table you are visualizing, or a vector of feature names
if the relevant comparison table will only have one feature type noted.</p></dd>


<dt id="arg-highlight-shape">highlight_shape<a class="anchor" aria-label="anchor" href="#arg-highlight-shape"></a></dt>
<dd><p>Shape of points overlayed on highlighted features. Defaults
to an open circle</p></dd>


<dt id="arg-highlight-size-diff">highlight_size_diff<a class="anchor" aria-label="anchor" href="#arg-highlight-size-diff"></a></dt>
<dd><p>Sets how much larger should the points overlayed on the highlighted
features be than the original plot points.</p></dd>


<dt id="arg-highlight-stroke">highlight_stroke<a class="anchor" aria-label="anchor" href="#arg-highlight-stroke"></a></dt>
<dd><p>Stroke width of the points overlayed on the highlighted
features.</p></dd>


<dt id="arg-highlight-fill">highlight_fill<a class="anchor" aria-label="anchor" href="#arg-highlight-fill"></a></dt>
<dd><p>Fill color of the points overlayed on the highlighted
features. Default is for them to be fill-less (<code>highlight_fill == NA</code>).</p></dd>


<dt id="arg-highlight-color">highlight_color<a class="anchor" aria-label="anchor" href="#arg-highlight-color"></a></dt>
<dd><p>Color of the points overlayed on the highlighted points.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot2</code> object. Y-axis = log2(estimate of interest (e.g., fold-change
in degradation rate constant); X-axis = log10(average normalized read coverage);
points colored by location relative to FDR and effect size cutoffs.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>EZMAPlot()</code> accepts as input the output of <code><a href="CompareParameters.html">CompareParameters()</a></code>, i.e.,
an <code>EZbakRData</code> object with at least one "comparisons" table. It will plot
the "avg_coverage" column in this table vs. the "difference" column.
In the simplest case, "difference" represents a log-fold change in a kinetic
parameter (e.g., kdeg) estimate. More complicated linear model fits and
comparisons can yield different parameter estimates.</p>
<p>NOTE: some outputs of <code><a href="CompareParameters.html">CompareParameters()</a></code> are not meant for visualization
via an MA plot. For example, when fitting certain interaction models,
some of the parameter estimates may represent average log(kinetic paramter)
in one condition. See discussion of one example of this <a href="https://github.com/simonlabcode/bakR/issues/7#issuecomment-2371431127" class="external-link">here</a>.</p>
<p>EZbakR estimates kinetic parameters in <code><a href="EstimateKinetics.html">EstimateKinetics()</a></code> and <code><a href="EZDynamics.html">EZDynamics()</a></code>
on a log-scale. By default, since log2-fold changes are a bit easier to interpret
and more common for these kind of visualizations, <code>EZMAPlot()</code> multiplies
the y-axis value by log2(exp(1)), which is the factor required to convert from
a log to a log2 scale. You can turn this off by setting <code>plotlog2</code> to <code>FALSE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate data to analyze</span></span></span>
<span class="r-in"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="EZSimulate.html">EZSimulate</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create EZbakR input</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="EZbakRData.html">EZbakRData</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">$</span><span class="va">cB</span>, <span class="va">simdata</span><span class="op">$</span><span class="va">metadf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate Fractions</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="EstimateFractions.html">EstimateFractions</a></span><span class="op">(</span><span class="va">ezbdo</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating mutation rates</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Summarizing data for feature(s) of interest</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Averaging out the nucleotide counts for improved efficiency</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating fractions</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing output</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate Kinetics</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="EstimateKinetics.html">EstimateKinetics</a></span><span class="op">(</span><span class="va">ezbdo</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Average estimates across replicate</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="AverageAndRegularize.html">AverageAndRegularize</a></span><span class="op">(</span><span class="va">ezbdo</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting linear model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating coverage vs. variance trend</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regularizing variance estimates</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare parameters across conditions</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="CompareParameters.html">CompareParameters</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span>,</span></span>
<span class="r-in"><span>design_factor <span class="op">=</span> <span class="st">"treatment"</span>,</span></span>
<span class="r-in"><span>reference <span class="op">=</span> <span class="st">"treatment1"</span>,</span></span>
<span class="r-in"><span>experimental <span class="op">=</span> <span class="st">"treatment2"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make MA plot (ggplot object that you can save and add/modify layers)</span></span></span>
<span class="r-in"><span><span class="fu">EZMAPlot</span><span class="op">(</span><span class="va">ezbdo</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EZMAPlot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

