<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Normalize for experimental/bioinformatic dropout of labeled RNA. — NormalizeForDropout • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Normalize for experimental/bioinformatic dropout of labeled RNA. — NormalizeForDropout"><meta name="description" content="Uses the strategy described here, and similar to that originally presented
in Berg et al. 2024,
to normalize for dropout. Normalizing for dropout means identifying a reference
sample with low dropout, and estimating dropout in each sample relative to
that sample."><meta property="og:description" content="Uses the strategy described here, and similar to that originally presented
in Berg et al. 2024,
to normalize for dropout. Normalizing for dropout means identifying a reference
sample with low dropout, and estimating dropout in each sample relative to
that sample."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">Convenient fetching of EZbakR outputs: EZget()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">Universal first step: EstimateFractions()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">Standard kinetic parameter estimation: EstimateKinetics()</a></li>
    <li><a class="dropdown-item" href="../articles/Linear-modeling.html">Linear modeling in EZbakR</a></li>
    <li><a class="dropdown-item" href="../articles/EZDynamics.html">Dynamical systems modeling in EZbakR: EZDynamics()</a></li>
    <li><a class="dropdown-item" href="../articles/EZQC.html">QCing your NR-seq data with EZbakR: EZQC()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Normalize for experimental/bioinformatic dropout of labeled RNA.</h1>

      <div class="d-none name"><code>NormalizeForDropout.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the strategy described <a href="https://simonlabcode.github.io/bakR/articles/Dropout.html" class="external-link">here</a>, and similar to that originally presented
in <a href="https://academic.oup.com/nar/article/52/7/e35/7612100" class="external-link">Berg et al. 2024</a>,
to normalize for dropout. Normalizing for dropout means identifying a reference
sample with low dropout, and estimating dropout in each sample relative to
that sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NormalizeForDropout</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  normalize_across_tls <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  grouping_factors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  populations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fraction_design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repeatID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exactMatch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  read_cutoff <span class="op">=</span> <span class="fl">25</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An EZbakRFractions object, which is an EZbakRData object on which
you have run <code><a href="EstimateFractions.html">EstimateFractions()</a></code>.</p></dd>


<dt id="arg-normalize-across-tls">normalize_across_tls<a class="anchor" aria-label="anchor" href="#arg-normalize-across-tls"></a></dt>
<dd><p>If TRUE, samples from different label times will
be normalized by finding a max inferred degradation rate constant (kdeg)
sample and using that as a reference. Degradation kinetics with this max
will be assumed to infer reference fraction news at different label times</p></dd>


<dt id="arg-grouping-factors">grouping_factors<a class="anchor" aria-label="anchor" href="#arg-grouping-factors"></a></dt>
<dd><p>Which sample-detail columns in the metadf should be used
to group -s4U samples by for calculating the average -s4U RPM? The default value of
<code>NULL</code> will cause no sample-detail columns to be used.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>Character vector of the set of features you want to stratify
reads by and estimate proportions of each RNA population. The default of <code>NULL</code>
will expect there to be only one fractions table in the EZbakRFractions object.</p></dd>


<dt id="arg-populations">populations<a class="anchor" aria-label="anchor" href="#arg-populations"></a></dt>
<dd><p>Mutational populations that were analyzed to generate the
fractions table to use. For example, this would be "TC" for a standard
s4U-based nucleotide recoding experiment.</p></dd>


<dt id="arg-fraction-design">fraction_design<a class="anchor" aria-label="anchor" href="#arg-fraction-design"></a></dt>
<dd><p>"Design matrix" specifying which RNA populations exist
in your samples. By default, this will be created automatically and will assume
that all combinations of the <code>mutrate_populations</code> you have requested to analyze are
present in your data. If this is not the case for your data, then you will have
to create one manually. See docs for <code>EstimateFractions</code> (run ?EstimateFractions()) for more details.</p></dd>


<dt id="arg-repeatid">repeatID<a class="anchor" aria-label="anchor" href="#arg-repeatid"></a></dt>
<dd><p>If multiple <code>fractions</code> tables exist with the same metadata,
then this is the numerical index by which they are distinguished.</p></dd>


<dt id="arg-exactmatch">exactMatch<a class="anchor" aria-label="anchor" href="#arg-exactmatch"></a></dt>
<dd><p>If TRUE, then <code>features</code> must exactly match the <code>features</code>
metadata for a given fractions table for it to be used. Means that you cannot
specify a subset of features by default. Set this to FALSE if you would like
to specify a feature subset.</p></dd>


<dt id="arg-read-cutoff">read_cutoff<a class="anchor" aria-label="anchor" href="#arg-read-cutoff"></a></dt>
<dd><p>Minimum number of reads for a feature to be used to fit
dropout model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>EZbakRData</code> object with the specified "fractions" table replaced
with a dropout corrected table.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>NormalizeForDropout()</code> has a number of unique advantages relative to
<code><a href="CorrectDropout.html">CorrectDropout()</a></code>:</p><ul><li><p><code>NormalizeForDropout()</code> doesn't require -label control data.</p></li>
<li><p><code>NormalizeForDropout()</code> compares an internally normalized quantity
(fraction new) across samples, which has some advantages over the
absolute dropout estimates derived from comparisons of normalized read
counts in <code><a href="CorrectDropout.html">CorrectDropout()</a></code>.</p></li>
<li><p><code>NormalizeForDropout()</code> may be used to normalize half-life estimates
across very different biological contexts (e.g., different cell types).</p></li>
</ul><p>There are also some caveats to be aware of when using <code>NormalizeForDropout()</code>:</p><ul><li><p>Be careful using <code>NormalizeForDropout()</code> when you have multiple different
label times. Dropout normalization requires each sample be compared to a reference
sample with the same label time. Thus, normalization will be performed
separately for groups of samples with different label times. If the extent
of dropout in the references with different label times is different, there
will still be unaccounted for dropout biases between some of the samples.</p></li>
<li><p><code>NormalizeForDropout()</code> effectively assumes that there are no true global
differences in turnover kinetics of RNA. If such differences actually exist
(e.g., half-lives in one context are on average truly lower than those in
another), <code>NormalizeForDropout()</code> risks normalizing away these real
differences. This is similar to how statistical normalization strategies
implemented in differential expression analysis software like DESeq2 assumes
that there are no global differences in RNA levels.</p></li>
</ul><p>By default, all samples with same label time are normalized with respect
to a reference sample chosen from among them. If you want to further separate
the groups of samples that are normalized together, specify the columns of
your metadf by which you want to additionally group factors in the <code>grouping_factors</code>
parameter. This behavior can be changed by setting <code>normalize_across_tls</code> to
<code>TRUE</code>, which will</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

