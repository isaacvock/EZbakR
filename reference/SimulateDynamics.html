<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulation of generalized dynamical system model. — SimulateDynamics • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of generalized dynamical system model. — SimulateDynamics"><meta name="description" content="SimulateDynamics() simulates any specified dynamical system of interconverting
RNA species. Its required input is similar to that of EstimateDynamics(), i.e.,
an adjacency matrix describing the set of species and how they are related to
one another and a list of formula relating actually assayed species to the
modeled species. Currently, SimulateDynamics() implements a naive heteroskedastic
replicate variability simulation and is not designed to simulate multiple experimental
conditions."><meta property="og:description" content="SimulateDynamics() simulates any specified dynamical system of interconverting
RNA species. Its required input is similar to that of EstimateDynamics(), i.e.,
an adjacency matrix describing the set of species and how they are related to
one another and a list of formula relating actually assayed species to the
modeled species. Currently, SimulateDynamics() implements a naive heteroskedastic
replicate variability simulation and is not designed to simulate multiple experimental
conditions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">Convenient fetching of EZbakR outputs: EZget()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">Universal first step: EstimateFractions()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">Standard kinetic parameter estimation: EstimateKinetics()</a></li>
    <li><a class="dropdown-item" href="../articles/Linear-modeling.html">Linear modeling in EZbakR</a></li>
    <li><a class="dropdown-item" href="../articles/EZDynamics.html">Dynamical systems modeling in EZbakR: EZDynamics()</a></li>
    <li><a class="dropdown-item" href="../articles/EZQC.html">QCing your NR-seq data with EZbakR: EZQC()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation of generalized dynamical system model.</h1>

      <div class="d-none name"><code>SimulateDynamics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>SimulateDynamics()</code> simulates any specified dynamical system of interconverting
RNA species. Its required input is similar to that of <code>EstimateDynamics()</code>, i.e.,
an adjacency matrix describing the set of species and how they are related to
one another and a list of formula relating actually assayed species to the
modeled species. Currently, <code>SimulateDynamics()</code> implements a naive heteroskedastic
replicate variability simulation and is not designed to simulate multiple experimental
conditions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimulateDynamics</span><span class="op">(</span></span>
<span>  <span class="va">nfeatures</span>,</span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">metadf</span>,</span>
<span>  <span class="va">log_means</span>,</span>
<span>  <span class="va">log_sds</span>,</span>
<span>  ntreatments <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  treatment_effects <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unassigned_name <span class="op">=</span> <span class="st">"__no_feature"</span>,</span>
<span>  seqdepth <span class="op">=</span> <span class="va">nfeatures</span> <span class="op">*</span> <span class="fl">2500</span>,</span>
<span>  dispersion <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  lfn_sd <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  effect_avg_default <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  effect_sd_default <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  fraction_affected_default <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nfeatures">nfeatures<a class="anchor" aria-label="anchor" href="#arg-nfeatures"></a></dt>
<dd><p>Number of "features" to simulate data for. A "feature" in this case
may contain a number of "sub-features". For example, you may want to simulate pre-RNA
and mature RNA for a set of "genes", in which case the number of features is the number
of genes.</p></dd>


<dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>An adjacency matrix describing the reaction diagram graph relating
the various RNA species to one another.</p></dd>


<dt id="arg-metadf">metadf<a class="anchor" aria-label="anchor" href="#arg-metadf"></a></dt>
<dd><p>Data frame with two required columns (<code>sample</code> and <code>tl</code>). <code>sample</code>
represents names given to each simulated sample. <code>tl</code> represents the label time
for that sample. Additional columns can specify other features of the sample,
like what subcellular compartment the sample is taken from. <strong>NOTE: Not sure I am
actually using these optional columns in any useful capacity anymore</strong>.</p></dd>


<dt id="arg-log-means">log_means<a class="anchor" aria-label="anchor" href="#arg-log-means"></a></dt>
<dd><p>Vector of log-Normal logmeans from which the distribution of
feature-specific parameters will be drawn from. Length of vector should be the same
as max(entries in <code>graph</code>), i.e., the number of parameters in your specified model.</p></dd>


<dt id="arg-log-sds">log_sds<a class="anchor" aria-label="anchor" href="#arg-log-sds"></a></dt>
<dd><p>Vector of log-Normal logsds from which the distribution of
feature-specific parameters will be drawn from.</p></dd>


<dt id="arg-ntreatments">ntreatments<a class="anchor" aria-label="anchor" href="#arg-ntreatments"></a></dt>
<dd><p>Number of distinct experimental treatments to simulate. By default,
only a single "treatment" (you might refer to this as wild-type, or control) is simulated.
Increase this if you would like to explore performing comparative dynamical systems
modeling.</p></dd>


<dt id="arg-treatment-effects">treatment_effects<a class="anchor" aria-label="anchor" href="#arg-treatment-effects"></a></dt>
<dd><p>Data frame describing effects of treatment on each
parameter. Should have five columns: "parameter_index", "treatment_index", "mean", "sd",
and "fraction_affected".
Each row corresponds to the effect the ith (i = treatment_index) treatment has on the
jth (j = parameter_index) kinetic parameter. Effect sizes, on a log-scale, are drawn from
a Normal distribution with mean and standard deviation set by the mean and sd columns,
respectively. The number of non-zero effects is set by "fraction_affected", and is
equal to <code>ceiling(nfeatures * fraction_affected)</code>. treatment_index of 1 will be ignored
and can either be included or not.</p></dd>


<dt id="arg-formula-list">formula_list<a class="anchor" aria-label="anchor" href="#arg-formula-list"></a></dt>
<dd><p>A list of named lists. The names of each sub-list should be
the same as the sample names as they are found in <code>metadf</code>. Each sub-list should be
a list of formula relating feature names that will show up as columns of the simulated
cB to species modeled in your <code>graph</code>. This only needs to be specified if you want
to simulate the scenario where some of the measured species are a sum of modeled species.</p></dd>


<dt id="arg-unassigned-name">unassigned_name<a class="anchor" aria-label="anchor" href="#arg-unassigned-name"></a></dt>
<dd><p>String to give to reads not assigned to a given feature.</p></dd>


<dt id="arg-seqdepth">seqdepth<a class="anchor" aria-label="anchor" href="#arg-seqdepth"></a></dt>
<dd><p>Total number of reads in each sample.</p></dd>


<dt id="arg-dispersion">dispersion<a class="anchor" aria-label="anchor" href="#arg-dispersion"></a></dt>
<dd><p>Negative binomial <code>size</code> parameter to use for simulating read counts</p></dd>


<dt id="arg-lfn-sd">lfn_sd<a class="anchor" aria-label="anchor" href="#arg-lfn-sd"></a></dt>
<dd><p>Logit(fn) replicate variability.</p></dd>


<dt id="arg-effect-avg-default">effect_avg_default<a class="anchor" aria-label="anchor" href="#arg-effect-avg-default"></a></dt>
<dd><p>If <code>ntreatments</code> &gt; 1, and <code>treatment_effects</code> is not
provided, this will be the value of <code>mean</code> for all treatments and parameters imputed
in <code>treatment_effects</code>.</p></dd>


<dt id="arg-effect-sd-default">effect_sd_default<a class="anchor" aria-label="anchor" href="#arg-effect-sd-default"></a></dt>
<dd><p>If <code>ntreatments</code> &gt; 1, and <code>treatment_effects</code> is not
provided, this will be the value of <code>sd</code> for all treatments and parameters imputed
in <code>treatment_effects</code>.</p></dd>


<dt id="arg-fraction-affected-default">fraction_affected_default<a class="anchor" aria-label="anchor" href="#arg-fraction-affected-default"></a></dt>
<dd><p>If <code>ntreatments</code> &gt; 1, and <code>treatment_effects</code> is not
provided, this will be the value of <code>fraction_affected</code> for all treatments and parameters imputed
in <code>treatment_effects</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Parameters passed to <code><a href="SimulateOneRep.html">SimulateOneRep()</a></code>.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

