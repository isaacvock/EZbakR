<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Average parameter estimates across replicates, and regularize variance estimates — AverageAndRegularize • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Average parameter estimates across replicates, and regularize variance estimates — AverageAndRegularize"><meta name="description" content="AverageAndRegularize uses a linear model to average estimates of a parameter
of interest over replicates, and to get averages for all of a set of conditions
specified by the user. This specification is done through formulas that will
be used to create a design matrix for parameters to estimate. Currently,
some design matrices will yield much longer runtimes than others. This is due
to some design matrices necessitating numerically estimating a set of maximum
likelihood parameters, while others yield simple, analytic approximations that
are quick to calculate. For example, formulas such as ~ treatment or
~ treatment:duration will be quick to fit, and formulas such as
~ treatment + batch are currently much slower to fit. This will eventually
be remedied through approximation of the solution to all full models."><meta property="og:description" content="AverageAndRegularize uses a linear model to average estimates of a parameter
of interest over replicates, and to get averages for all of a set of conditions
specified by the user. This specification is done through formulas that will
be used to create a design matrix for parameters to estimate. Currently,
some design matrices will yield much longer runtimes than others. This is due
to some design matrices necessitating numerically estimating a set of maximum
likelihood parameters, while others yield simple, analytic approximations that
are quick to calculate. For example, formulas such as ~ treatment or
~ treatment:duration will be quick to fit, and formulas such as
~ treatment + batch are currently much slower to fit. This will eventually
be remedied through approximation of the solution to all full models."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">EZget</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">EstimateFractions</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">EstimateKinetics</a></li>
    <li><a class="dropdown-item" href="../articles/AverageAndRegularize.html">AverageAndRegularize</a></li>
    <li><a class="dropdown-item" href="../articles/CompareParameters.html">CompareParameters</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Average parameter estimates across replicates, and regularize variance estimates</h1>

      <div class="d-none name"><code>AverageAndRegularize.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>AverageAndRegularize</code> uses a linear model to average estimates of a parameter
of interest over replicates, and to get averages for all of a set of conditions
specified by the user. This specification is done through formulas that will
be used to create a design matrix for parameters to estimate. Currently,
some design matrices will yield much longer runtimes than others. This is due
to some design matrices necessitating numerically estimating a set of maximum
likelihood parameters, while others yield simple, analytic approximations that
are quick to calculate. For example, formulas such as <code>~ treatment</code> or
<code>~ treatment:duration</code> will be quick to fit, and formulas such as
<code>~ treatment + batch</code> are currently much slower to fit. This will eventually
be remedied through approximation of the solution to all full models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AverageAndRegularize</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parameter <span class="op">=</span> <span class="st">"log_kdeg"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"kinetics"</span>,</span>
<span>  kstrat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  populations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fraction_design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exactMatch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  repeatID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula_mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula_sd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_all_parameters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sd_reg_factor <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  error_if_singular <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_reads <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  force_optim <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conservative <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  character_limit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An <code>EZbakRFractions</code> object, which is an <code>EZbakRData</code> object on
which <code><a href="EstimateFractions.html">EstimateFractions()</a></code> has been run.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>Character vector of the set of features you want to stratify
reads by and estimate proportions of each RNA population. The default of "all"
will use all feature columns in the <code>obj</code>'s cB.</p></dd>


<dt id="arg-parameter">parameter<a class="anchor" aria-label="anchor" href="#arg-parameter"></a></dt>
<dd><p>Parameter to average across replicates of a given condition.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>What type of table is the parameter found in? Default is "kinetics",
but can also set to "fractions".</p></dd>


<dt id="arg-kstrat">kstrat<a class="anchor" aria-label="anchor" href="#arg-kstrat"></a></dt>
<dd><p>If <code>type == "kinetics"</code>, then <code>kstrat</code> specifies the kinetic parameter
inference strategy.</p></dd>


<dt id="arg-exactmatch">exactMatch<a class="anchor" aria-label="anchor" href="#arg-exactmatch"></a></dt>
<dd><p>If TRUE, then <code>features</code> and <code>populations</code> have to exactly match
those for a given fractions table for that table to be used. Means that you can't
specify a subset of features or populations by default, since this is TRUE
by default.</p></dd>


<dt id="arg-repeatid">repeatID<a class="anchor" aria-label="anchor" href="#arg-repeatid"></a></dt>
<dd><p>If multiple <code>kinetics</code> or <code>fractions</code> tables exist with the same metadata,
then this is the numerical index by which they are distinguished.</p></dd>


<dt id="arg-formula-mean">formula_mean<a class="anchor" aria-label="anchor" href="#arg-formula-mean"></a></dt>
<dd><p>An R formula object specifying how the <code>parameter</code> of interest
depends on the sample characteristics specified in <code>obj</code>'s metadf. The most common formula
will be <code>~ treatment</code> or <code>~ treatment:duration</code>, where <code>treatment</code> and <code>duration</code> would
be replaced with whatever you called the relevant sample characteristics in your metadf.
<code>~ treatment</code> means that an average value of <code>parameter</code> should be estimated for each
set of samples with the same value for <code>treatment</code> in the metadf. <code>~ treatment:duration</code> specifies
that an average value of <code>parameter</code> should be estimated for each set of samples with the same
combination of <code>treatment</code> and <code>duration</code> values in the metadf. An example of the latter
case is a situation where you have two or more treatments (e.g., drug treated and untreated control)
which were applied for different durations of time (e.g., 4 and 8 hours).</p></dd>


<dt id="arg-formula-sd">formula_sd<a class="anchor" aria-label="anchor" href="#arg-formula-sd"></a></dt>
<dd><p>Same as <code>formula_mean</code>, but this time specifying how the variance
in the replicate estimates of <code>parameter</code> depends on the sample characteristics specified
in <code>obj</code>'s metadf. Unlike standard linear modeling, this allows you to specify
a heteroskedastic model. I suggest allowing a <code>parameter</code>'s variance to depend on
the "treatment" condition, as changes in relative RNA abundance can impact <code>parameter</code> variance,
so differential expression caused by your "treatment" could impact <code>parameter</code> variance.</p></dd>


<dt id="arg-include-all-parameters">include_all_parameters<a class="anchor" aria-label="anchor" href="#arg-include-all-parameters"></a></dt>
<dd><p>If TRUE, an additional table will be saved with the prefix <code>fullfit_</code>,
which includes all of the parameters estimated throughout the course of linear modeling and
regularization. This can be nice for visualizing the regularized mean-variance trend.</p></dd>


<dt id="arg-sd-reg-factor">sd_reg_factor<a class="anchor" aria-label="anchor" href="#arg-sd-reg-factor"></a></dt>
<dd><p>Determines how strongly variance estimates are shrunk towards trend.
Higher numbers lead to more regularization. Eventually, this will be replaced with estimation
of how much variance there seems to be in the population of variances.</p></dd>


<dt id="arg-error-if-singular">error_if_singular<a class="anchor" aria-label="anchor" href="#arg-error-if-singular"></a></dt>
<dd><p>If TRUE, linear model will throw an error if parameters
cannot be uniquely identified. This is most often caused by parameters that cannot
be estimated from the data, e.g., due to limited replicate numbers or correlated
sample characteristics (i.e., all treatment As also correspond to batch As, and
all treatment Bs correspond to batch Bs).</p></dd>


<dt id="arg-min-reads">min_reads<a class="anchor" aria-label="anchor" href="#arg-min-reads"></a></dt>
<dd><p>Minimum number of reads in all samples for a feature to be kept.</p></dd>


<dt id="arg-force-optim">force_optim<a class="anchor" aria-label="anchor" href="#arg-force-optim"></a></dt>
<dd><p>Perform numerical likelihood estimation, even if a more efficient,
approximate, analytical strategy is possible given <code>formula_mean</code> and <code>formula_sd</code>.</p></dd>


<dt id="arg-conservative">conservative<a class="anchor" aria-label="anchor" href="#arg-conservative"></a></dt>
<dd><p>If TRUE, conservative variance regularation will be performed.
In this case, variances below the trend will be regularized up to the trend, and
variances above the trend will be left unregularized. This avoids underestimation
of variances.</p></dd>


<dt id="arg-character-limit">character_limit<a class="anchor" aria-label="anchor" href="#arg-character-limit"></a></dt>
<dd><p>Limit on the number of characters of the name given to the
output table. Will attempt to concatenate the parameter name with the names of all
of the features. If this is too long, only the parameter name will be used.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>If TRUE, identical, existing output will be overwritten.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

