<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate NR-seq data for multiple replicates of multiple biological conditions — SimulateMultiCondition • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate NR-seq data for multiple replicates of multiple biological conditions — SimulateMultiCondition"><meta name="description" content="SimulateMultiCondition is a highly flexibly simulator that combines linear modeling
of log(kdeg)'s and log(ksyn)'s with SimulateOneRep to simulate an NR-seq dataset. The linear model
allows you to simulate multiple distinct treatments, batch effects, interaction effects,
etc. The current downside for its flexibility is its relative complexity to implement.
Easier to use simulators are on the way to EZbakR."><meta property="og:description" content="SimulateMultiCondition is a highly flexibly simulator that combines linear modeling
of log(kdeg)'s and log(ksyn)'s with SimulateOneRep to simulate an NR-seq dataset. The linear model
allows you to simulate multiple distinct treatments, batch effects, interaction effects,
etc. The current downside for its flexibility is its relative complexity to implement.
Easier to use simulators are on the way to EZbakR."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">Convenient fetching of EZbakR outputs: EZget()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">Universal first step: EstimateFractions()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">Standard kinetic parameter estimation: EstimateKinetics()</a></li>
    <li><a class="dropdown-item" href="../articles/Linear-modeling.html">Linear modeling in EZbakR</a></li>
    <li><a class="dropdown-item" href="../articles/EZDynamics.html">Dynamical systems modeling in EZbakR: EZDynamics()</a></li>
    <li><a class="dropdown-item" href="../articles/EZQC.html">QCing your NR-seq data with EZbakR: EZQC()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate NR-seq data for multiple replicates of multiple biological conditions</h1>

      <div class="d-none name"><code>SimulateMultiCondition.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>SimulateMultiCondition</code> is a highly flexibly simulator that combines linear modeling
of log(kdeg)'s and log(ksyn)'s with <code>SimulateOneRep</code> to simulate an NR-seq dataset. The linear model
allows you to simulate multiple distinct treatments, batch effects, interaction effects,
etc. The current downside for its flexibility is its relative complexity to implement.
Easier to use simulators are on the way to EZbakR.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimulateMultiCondition</span><span class="op">(</span></span>
<span>  <span class="va">nfeatures</span>,</span>
<span>  <span class="va">metadf</span>,</span>
<span>  <span class="va">mean_formula</span>,</span>
<span>  param_details <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seqdepth <span class="op">=</span> <span class="va">nfeatures</span> <span class="op">*</span> <span class="fl">2500</span>,</span>
<span>  label_time <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  pnew <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pold <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  readlength <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  Ucont_alpha <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  Ucont_beta <span class="op">=</span> <span class="fl">75</span>,</span>
<span>  feature_prefix <span class="op">=</span> <span class="st">"Gene"</span>,</span>
<span>  dispslope <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  dispint <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  logkdegsdtrend_slope <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>,</span>
<span>  logkdegsdtrend_intercept <span class="op">=</span> <span class="op">-</span><span class="fl">2.25</span>,</span>
<span>  logksynsdtrend_slope <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>,</span>
<span>  logksynsdtrend_intercept <span class="op">=</span> <span class="op">-</span><span class="fl">2.25</span>,</span>
<span>  logkdeg_mean <span class="op">=</span> <span class="op">-</span><span class="fl">1.9</span>,</span>
<span>  logkdeg_sd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  logksyn_mean <span class="op">=</span> <span class="fl">2.3</span>,</span>
<span>  logksyn_sd <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  logkdeg_diff_avg <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  logksyn_diff_avg <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  logkdeg_diff_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  logksyn_diff_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pdiff_kd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  pdiff_ks <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pdiff_both <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pdo <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nfeatures">nfeatures<a class="anchor" aria-label="anchor" href="#arg-nfeatures"></a></dt>
<dd><p>Number of "features" (e.g., genes) to simulate data for</p></dd>


<dt id="arg-metadf">metadf<a class="anchor" aria-label="anchor" href="#arg-metadf"></a></dt>
<dd><p>A data frame with the following columns:</p><ul><li><p>sample: Names given to samples to simulate.</p></li>
<li><p><details>: Any number of columns with any names (not taken by other metadf columns)
storing factors by which the samples can be stratified. These can be referenced
in <code>mean_formula</code>, described below.</details></p></li>
</ul><p>These parameters (described more below) can also be included in metadf to specify sample-specific simulation
parameter:</p><ul><li><p>seqdepth</p></li>
<li><p>label_time</p></li>
<li><p>pnew</p></li>
<li><p>pold</p></li>
<li><p>readlength</p></li>
<li><p>Ucont</p></li>
</ul></dd>


<dt id="arg-mean-formula">mean_formula<a class="anchor" aria-label="anchor" href="#arg-mean-formula"></a></dt>
<dd><p>A formula object that specifies the linear model used to
relate the factors in the <details> columns of <code>metadf</code> to average log(kdegs) and
log(ksyns) in each sample.</details></p></dd>


<dt id="arg-param-details">param_details<a class="anchor" aria-label="anchor" href="#arg-param-details"></a></dt>
<dd><p>A data frame with one row for each column of the design matrix
obtained from <code>model.matrix(mean_formula, metadf)</code> that describes how to simulate
the linear model parameters. The columns of this data frame are:</p><ul><li><p>param: Name of linear model parameter as it appears in the column names of the
design matrix from <code>model.matrix(mean_formula, metadf)</code>.</p></li>
<li><p>reference: Boolean; TRUE if you want to treat that parameter as a "reference". This
means that all other parameter values that aren't global parameters are set equal to this
unless otherwise determined (see <code>pdiff_*</code> parameters for how it is determined if a parameter
will differ from the reference).</p></li>
<li><p>global: Boolean; TRUE if you want to treat that parameter as a global parameter. This means
that a single value is used for all features.</p></li>
<li><p>logkdeg_mean: If parameter is the reference, then its value for the log(kdeg) linear model
will be drawn from a normal distribution with this mean. If it is a global parameter, then this
value will be used. If it is neither of these, then its value in the log(kdeg) linear model will
either be the reference (if there is no difference between this condition's value and the reference)
or the reference's value + a normally distributed random variable centered on this value.</p></li>
<li><p>logkdeg_sd: sd used for draws from normal distribution as described for <code>logkdeg_mean</code>.</p></li>
<li><p>logksyn_mean: Same as <code>logkdeg_mean</code> but for log(ksyn) linear model.</p></li>
<li><p>logksyn_sd: Same as <code>logkdeg_sd</code> but for log(kdeg) linear model.</p></li>
<li><p>pdiff_ks: Proportion of features whose value of this parameter in the log(ksyn) linear model
will differ from the reference's. Should be a number between 0 and 1, inclusive. For example, if
<code>pdiff_ks</code> is 0.1, then for 10% of features, this parameter will equal the reference parameter +
a normally distributed random variable with mean <code>logksyn_mean</code> and sd <code>logksyn_sd</code>. For the other
90% of features, this parameter will equal the reference.</p></li>
<li><p>pdiff_kd: Same as <code>pdiff_ks</code> but for log(kdeg) linear model.</p></li>
<li><p>pdiff_both: Proportion of features whose value for this parameter in BOTH the
log(kdeg) and log(ksyn) linear models will differ from the reference. Value must be
between 0 and min(c(pdiff_kd, pdiff_ks)) in that row.</p></li>
</ul><p>If param_details is not specified by the user, the first column of the design matrix
is assumed to represent the reference parameter, all parameters are assumed to be
non-global, logkdeg_mean and logksyn_mean are set to the equivalently named parameter values
described below for the reference and <code>logkdeg_diff_avg</code> and <code>logksyn_diff_avg</code> for all other parameters,
logkdeg_sd and logksyn_sd are set to the equivalently named parameter values
described below for the reference and <code>logkdeg_diff_sd</code> and <code>logksyn_diff_sd</code> for all other parameters,
and pdiff_kd, pdiff_ks, and pdiff_both are all set to the equivalently named parameter values.</p></dd>


<dt id="arg-seqdepth">seqdepth<a class="anchor" aria-label="anchor" href="#arg-seqdepth"></a></dt>
<dd><p>Only relevant if <code>read_vect</code> is not provided; in that case, this is
the total number of reads to simulate.</p></dd>


<dt id="arg-label-time">label_time<a class="anchor" aria-label="anchor" href="#arg-label-time"></a></dt>
<dd><p>Length of s^4^U feed to simulate.</p></dd>


<dt id="arg-pnew">pnew<a class="anchor" aria-label="anchor" href="#arg-pnew"></a></dt>
<dd><p>Probability that a T is mutated to a C if a read is new.</p></dd>


<dt id="arg-pold">pold<a class="anchor" aria-label="anchor" href="#arg-pold"></a></dt>
<dd><p>Probability that a T is mutated to a C if a read is old.</p></dd>


<dt id="arg-readlength">readlength<a class="anchor" aria-label="anchor" href="#arg-readlength"></a></dt>
<dd><p>Length of simulated reads. In this simple simulation, all reads
are simulated as being exactly this length.</p></dd>


<dt id="arg-ucont-alpha">Ucont_alpha<a class="anchor" aria-label="anchor" href="#arg-ucont-alpha"></a></dt>
<dd><p>Probability that a nucleotide in a simulated read from a given feature
is a U is drawn from a beta distribution with shape1 = <code>Ucont_alpha</code>.</p></dd>


<dt id="arg-ucont-beta">Ucont_beta<a class="anchor" aria-label="anchor" href="#arg-ucont-beta"></a></dt>
<dd><p>Probability that a nucleotide in a simulated read from a given feature
is a U is drawn from a beta distribution with shape2 = <code>Ucont_beta</code>.</p></dd>


<dt id="arg-feature-prefix">feature_prefix<a class="anchor" aria-label="anchor" href="#arg-feature-prefix"></a></dt>
<dd><p>Name given to the i-th feature is <code>paste0(feature_prefix, i)</code>. Shows up in the
<code>feature</code> column of the output simulated data table.</p></dd>


<dt id="arg-dispslope">dispslope<a class="anchor" aria-label="anchor" href="#arg-dispslope"></a></dt>
<dd><p>Negative binomial dispersion parameter "slope" with respect to read counts. See
DESeq2 paper for dispersion model used.</p></dd>


<dt id="arg-dispint">dispint<a class="anchor" aria-label="anchor" href="#arg-dispint"></a></dt>
<dd><p>Negative binomial dispersion parameter "intercept" with respect to read counts. See
DESeq2 paper for dispersion model used.</p></dd>


<dt id="arg-logkdegsdtrend-slope">logkdegsdtrend_slope<a class="anchor" aria-label="anchor" href="#arg-logkdegsdtrend-slope"></a></dt>
<dd><p>Slope for log10(read count) vs. log(kdeg) replicate variability trend</p></dd>


<dt id="arg-logkdegsdtrend-intercept">logkdegsdtrend_intercept<a class="anchor" aria-label="anchor" href="#arg-logkdegsdtrend-intercept"></a></dt>
<dd><p>Intercept for log10(read count) vs. log(kdeg) replicate variability trend</p></dd>


<dt id="arg-logksynsdtrend-slope">logksynsdtrend_slope<a class="anchor" aria-label="anchor" href="#arg-logksynsdtrend-slope"></a></dt>
<dd><p>Slope for log10(read count) vs. log(ksyn) replicate variability trend</p></dd>


<dt id="arg-logksynsdtrend-intercept">logksynsdtrend_intercept<a class="anchor" aria-label="anchor" href="#arg-logksynsdtrend-intercept"></a></dt>
<dd><p>Intercept for log10(read count) vs. log(ksyn) replicate variability trend</p></dd>


<dt id="arg-logkdeg-mean">logkdeg_mean<a class="anchor" aria-label="anchor" href="#arg-logkdeg-mean"></a></dt>
<dd><p>Mean of normal distribution from which reference log(kdeg)
linear model parameter is drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-logkdeg-sd">logkdeg_sd<a class="anchor" aria-label="anchor" href="#arg-logkdeg-sd"></a></dt>
<dd><p>Standard deviation of normal distribution from which reference log(kdeg)
linear model parameter is drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-logksyn-mean">logksyn_mean<a class="anchor" aria-label="anchor" href="#arg-logksyn-mean"></a></dt>
<dd><p>Mean of normal distribution from which reference log(ksyn)
linear model parameter is drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-logksyn-sd">logksyn_sd<a class="anchor" aria-label="anchor" href="#arg-logksyn-sd"></a></dt>
<dd><p>Standard deviation of normal distribution from which reference log(ksyn)
linear model parameter is drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-logkdeg-diff-avg">logkdeg_diff_avg<a class="anchor" aria-label="anchor" href="#arg-logkdeg-diff-avg"></a></dt>
<dd><p>Mean of normal distribution from which non-reference log(kdeg)
linear model parameters are drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-logksyn-diff-avg">logksyn_diff_avg<a class="anchor" aria-label="anchor" href="#arg-logksyn-diff-avg"></a></dt>
<dd><p>Mean of normal distribution from which reference log(ksyn)
linear model parameter are drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-logkdeg-diff-sd">logkdeg_diff_sd<a class="anchor" aria-label="anchor" href="#arg-logkdeg-diff-sd"></a></dt>
<dd><p>Standard deviation of normal distribution from which reference log(kdeg)
linear model parameter are drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-logksyn-diff-sd">logksyn_diff_sd<a class="anchor" aria-label="anchor" href="#arg-logksyn-diff-sd"></a></dt>
<dd><p>Standard deviation of normal distribution from which reference log(ksyn)
linear model parameter are drawn from for each feature if <code>param_details</code> is not provided.</p></dd>


<dt id="arg-pdiff-kd">pdiff_kd<a class="anchor" aria-label="anchor" href="#arg-pdiff-kd"></a></dt>
<dd><p>Proportion of features for which non-reference log(kdeg) linear model parameters
differ from the reference.</p></dd>


<dt id="arg-pdiff-ks">pdiff_ks<a class="anchor" aria-label="anchor" href="#arg-pdiff-ks"></a></dt>
<dd><p>Proportion of features for which non-reference log(ksyn) linear model parameters
differ from the reference.</p></dd>


<dt id="arg-pdiff-both">pdiff_both<a class="anchor" aria-label="anchor" href="#arg-pdiff-both"></a></dt>
<dd><p>Proportion of features for which BOTH non-reference log(kdeg) and log(ksyn) linear model parameters
differ from the reference.
ksyns are simulated</p></dd>


<dt id="arg-pdo">pdo<a class="anchor" aria-label="anchor" href="#arg-pdo"></a></dt>
<dd><p>Dropout rate; think of this as the probability that a s4U containing
molecule is lost during library preparation and sequencing. If <code>pdo</code> is 0 (default)
then there is not dropout.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu">SimulateMultiCondition</span><span class="op">(</span><span class="fl">30</span>,</span></span>
<span class="r-in"><span>                                  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sampleA'</span>, <span class="st">'sampleB'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'treatment1'</span>, <span class="st">'treatment2'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  mean_formula <span class="op">=</span> <span class="op">~</span><span class="va">treatment</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

