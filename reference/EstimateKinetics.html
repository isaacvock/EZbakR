<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate kinetic parameters — EstimateKinetics • EZbakR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate kinetic parameters — EstimateKinetics"><meta name="description" content="Simple kinetic parameter (kdeg and ksyn) estimation using fraction estimates
from EstimateFractions(). Several slightly different kinetic parameter
inference strategies are implemented."><meta property="og:description" content="Simple kinetic parameter (kdeg and ksyn) estimation using fraction estimates
from EstimateFractions(). Several slightly different kinetic parameter
inference strategies are implemented."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EZbakR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quickstart.html">EZbakR for people in a hurry</a></li>
    <li><a class="dropdown-item" href="../articles/EZget.html">Convenient fetching of EZbakR outputs: EZget()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateFractions.html">Universal first step: EstimateFractions()</a></li>
    <li><a class="dropdown-item" href="../articles/EstimateKinetics.html">Standard kinetic parameter estimation: EstimateKinetics()</a></li>
    <li><a class="dropdown-item" href="../articles/Linear-modeling.html">Linear modeling in EZbakR</a></li>
    <li><a class="dropdown-item" href="../articles/EZDynamics.html">Dynamical systems modeling in EZbakR: EZDynamics()</a></li>
    <li><a class="dropdown-item" href="../articles/EZQC.html">QCing your NR-seq data with EZbakR: EZQC()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate kinetic parameters</h1>

      <div class="d-none name"><code>EstimateKinetics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simple kinetic parameter (kdeg and ksyn) estimation using fraction estimates
from <code><a href="EstimateFractions.html">EstimateFractions()</a></code>. Several slightly different kinetic parameter
inference strategies are implemented.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EstimateKinetics</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  strategy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standard"</span>, <span class="st">"tilac"</span>, <span class="st">"NSS"</span>, <span class="st">"shortfeed"</span>, <span class="st">"pulse-chase"</span><span class="op">)</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  populations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fraction_design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repeatID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exactMatch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grouping_factor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reference_factor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  character_limit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  feature_lengths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude_pulse_estimates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale_factors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An <code>EZbakRFractions</code> object, which is an <code>EZbakRData</code> object on
which <code><a href="EstimateFractions.html">EstimateFractions()</a></code> has been run.</p></dd>


<dt id="arg-strategy">strategy<a class="anchor" aria-label="anchor" href="#arg-strategy"></a></dt>
<dd><p>Kinetic parameter estimation strategy.
Options include:</p><ul><li><p>standard: Estimate a single new read and old read mutation rate for each
sample. This is done via a binomial mixture model aggregating over</p></li>
<li><p>NSS: Use strategy similar to that presented in Narain et al., 2021 that
assumes you have data which provides a reference for how much RNA was present
at the start of each labeling. In this case, <code>grouping_factor</code> and <code>reference_factor</code>
must also be set.</p></li>
<li><p>shortfeed: Estimate kinetic parameters assuming no degradation of labeled
RNA, most appropriate if the metabolic label feed time is much shorter than
the average half-life of an RNA in your system.</p></li>
<li><p>tilac: Estimate TILAC-ratio as described in Courvan et al., 2022.</p></li>
<li><p>pulse-chase: Estimate kdeg for a pulse-chase experiment. By default kdeg will be estimated
for each time point at which label was present. This includes any pulse-only samples,
as well as all samples including a chase after the pulse. If you don't want
to include the estimates from the pulse-only samples in the final output,
set <code>exclude_pulse_estimates</code> to <code>TRUE</code>. Pulse-chases are suboptimal for a number
of experimental reasons, so we urge users to avoid performing this kind of experiment
whenever possible (favoring instead a pulse-label design). One of the challenges of
analyzing pulse-chase data is that the fraction labeled after the pulse must be compared
to that after each chase. Due to a number of technical reasons, it is possible for the
estimated labeling after the chase to be *<em>higher</em> than that after the pulse. It is
impossible to estimate kinetic parameters in this case. Thus, when this arises,
a conservative kdeg estimate is imputed, equal to -log(1 - 1/(n+2))/tchase,
which is the kdeg estimate you would get if you had no detected reads from labeled
RNA and an uninformative prior on the fraction new (i.e., the estimated fraction
new is (number of reads from labeled RNA + 1) / (number of reads + 2)).</p></li>
</ul></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>Character vector of the set of features you want to stratify
reads by and estimate proportions of each RNA population. The default of "all"
will use all feature columns in the <code>obj</code>'s cB.</p></dd>


<dt id="arg-populations">populations<a class="anchor" aria-label="anchor" href="#arg-populations"></a></dt>
<dd><p>Mutational populations that were analyzed to generate the
fractions table to use. For example, this would be "TC" for a standard
s4U-based nucleotide recoding experiment.</p></dd>


<dt id="arg-fraction-design">fraction_design<a class="anchor" aria-label="anchor" href="#arg-fraction-design"></a></dt>
<dd><p>"Design matrix" specifying which RNA populations exist
in your samples. By default, this will be created automatically and will assume
that all combinations of the <code>mutrate_populations</code> you have requested to analyze are
present in your data. If this is not the case for your data, then you will have
to create one manually. See docs for <code>EstimateFractions</code> (run ?EstimateFractions()) for more details.</p></dd>


<dt id="arg-repeatid">repeatID<a class="anchor" aria-label="anchor" href="#arg-repeatid"></a></dt>
<dd><p>If multiple <code>fractions</code> tables exist with the same metadata,
then this is the numerical index by which they are distinguished.</p></dd>


<dt id="arg-exactmatch">exactMatch<a class="anchor" aria-label="anchor" href="#arg-exactmatch"></a></dt>
<dd><p>If TRUE, then <code>features</code> and <code>populations</code> have to exactly match
those for a given fractions table for that table to be used. Means that you can't
specify a subset of features or populations by default, since this is TRUE
by default.</p></dd>


<dt id="arg-grouping-factor">grouping_factor<a class="anchor" aria-label="anchor" href="#arg-grouping-factor"></a></dt>
<dd><p>Which sample-detail columns in the metadf should be used
to group samples by for calculating the average RPM (<code>strategy = "NSS"</code>) or
pulse fraction labeled (<code>strategy = "pulse-chase"</code>) at a particular time point?
Only relevant if <code>strategy = "NSS"</code> or <code>strategy = "pulse-chase"</code>.</p></dd>


<dt id="arg-reference-factor">reference_factor<a class="anchor" aria-label="anchor" href="#arg-reference-factor"></a></dt>
<dd><p>Which sample-detail column in the metafd should be used to
determine which group of samples provide information about the starting levels of RNA
for each sample? This should have values that match those in <code>grouping_factor</code>.
#' Only relevant if <code>strategy = "NSS"</code>.</p></dd>


<dt id="arg-character-limit">character_limit<a class="anchor" aria-label="anchor" href="#arg-character-limit"></a></dt>
<dd><p>Maximum number of characters for naming out fractions output. EZbakR
will try to name this as a "_" separated character vector of all of the features analyzed.
If this name is greater than <code>character_limit</code>, then it will default to "fraction#", where
"#" represents a simple numerical ID for the table.</p></dd>


<dt id="arg-feature-lengths">feature_lengths<a class="anchor" aria-label="anchor" href="#arg-feature-lengths"></a></dt>
<dd><p>Table of effective lengths for each feature combination in your
data. For example, if your analysis includes features named GF and XF, this
should be a data frame with columns GF, XF, and length.</p></dd>


<dt id="arg-exclude-pulse-estimates">exclude_pulse_estimates<a class="anchor" aria-label="anchor" href="#arg-exclude-pulse-estimates"></a></dt>
<dd><p>If <code>strategy = "pulse-chase"</code>, would you like
to exclude the pulse-only kdeg and ksyn estimates from the final output? This
is a good idea if you used a very long pulse with the goal of labeling close
to 100% of all RNA.</p></dd>


<dt id="arg-scale-factors">scale_factors<a class="anchor" aria-label="anchor" href="#arg-scale-factors"></a></dt>
<dd><p>Data frame with two columns, "sample" and "scale_factor".
sample should be the sample name, and scale_factor is the factor which read counts
in that sample should be <strong>divided</strong> to get the normalized read counts. This should match
the convention from DESeq2 and thus you can provide, for example, scale factors derived
from DESeq2 for this. By default, EZbakR uses DESeq2's median of ratios normalization
method, but specifying <code>scale_factors</code> is useful when you have spike-ins.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>If TRUE and a fractions estimate output already exists that
would possess the same metadata (features analyzed, populations analyzed,
and fraction_design), then it will get overwritten with the new output. Else,
it will be saved as a separate output with the same name + "_#" where "#" is a
numerical ID to distinguish the similar outputs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>EZbakRKinetics</code> object, which is just an <code>EZbakRData</code> object with
a "kinetics" slot. This includes tables of kinetic parameter estimates for
each feature in each sample for which kinetic parameters can be estimated.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>EstimateKinetics()</code> estimates the kinetics and RNA synthesis and degradation
from standard single-label NR-seq data. It also technically supports analyses
of the dual-label TILAC experiment, but that functionality is not as actively
tested or maintained as the more standard analyses.</p>
<p><code>EstimateKinetics()</code> assumes a simple linear ODE model of RNA dynamics:
$$\frac{\text{dR}}{\text{dt}} = k_{\text{syn}} - k_{\text{deg}}*\text{R}$$
where:</p><ul><li><p>R = Amount of RNA</p></li>
<li><p>\(k_{\text{syn}}\) = Synthesis rate constant</p></li>
<li><p>\(k_{\text{deg}}\) = Degradation rate constant
and for which the general solution is:
$$\text{R(t)} = \text{R(0)}e^{-k_{\text{deg}}\text{t}} + (1 - \frac{k_{\text{syn}}}{k_{\text{deg}}})e^{-k_{\text{deg}}\text{t}}  $$
where \(\text{R(0)}\) is the initial RNA level.</p></li>
</ul><p>The default kinetic parameter estimation strategy (<code>strategy == "standard"</code>)
assumes that for labeled RNA (or more precisely RNA synthesized in the presence
of label) \(\text{R(0)} = 0\). Thus, it assumes a pulse-label rather than
pulse-chase experimental design (I've written several places, like <a href="https://simonlabcode.github.io/bakR/articles/Troubleshooting.html#experimental-suggestions" class="external-link">here</a>
and <a href="https://isaacvock.github.io/EZbakR/articles/EstimateKinetics.html#pulse-chase-analyses">here</a>
for example, about why pulse-label designs are superior to pulse-chases in
almost all settings).</p>
<p>For unlabeled RNA, it assumes that \(\text{R(0)} = \frac{k_{\text{syn}}}{k_{\text{deg}}}\).
This is known as the steady-state assumption and is the key assumption of this method.
More broadly, assuming steady-state means that this method assumes that RNA levels
from a given feature are constant for the entire metabolic labeling duration.
As EZbakR is designed for analyses of bulk NR-seq data, "constant" means that the
average RNA levels across all profiled cells is constant (thus asynchronous populations
of dividing cells still count as steady-state, even if the RNA expression landscapes
in individual cells are quite dynamic). This assumption may be violated in cases
where labeling coincides with or closely follows a perturbation (e.g., drug treatment).
When the steady-state assumption hold, there is a simple relationship between the
fraction of reads from labeled RNA (\(\theta\)) and the turnover kinetics of the RNA:
$$\theta = 1 - e^{-k_{\text{deg}}t}$$
The power in this approach is thus that turnover kinetics are estimated from
an "internally normalized" quantity: \(\theta\) (termed the "fraction new",
"fraction labeled", "fraction high mutation content", or new-to-total ratio (NTR), depending
on where you look or who you ask). "Internally normalized" means that a normalization
scale factor does not need to be estimated in order to accurately infer turnover
kinetics. \(\theta\) represents a ratio of read counts from the same feature
in the same library, thus any scale factor would appear in both the numerator
and denominator of this estimate and cancel out.</p>
<p>When this assumption is valid, the <code>strategy = "NSS"</code> approach may be preferable.
This approach relies on the same model of RNA dynamics, but now assumes that the
initial RNA levels (\(\text{R(0)}\) for the unlabeled RNA) are not at the steady-state
levels dictated by the current synthesis and turnover kinetics. The idea for this
strategy was first presented in <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC8354102/" class="external-link">Narain et al. 2021</a>.
To run this approach, you need to be able to estimate the initial RNA levels of
each label-fed sample, as the fraction of reads from labeled RNA will no longer.
only reflect the turnover kinetics (as the old RNA is assumed to potentially
not have reached the new steady-state levels yet). This means that for each
label-fed sample, you need to have a sample whose assayed RNA population represents
the starting RNA population for the label-fed sample. EZbakR will use these
reference samples to infer \(\text{R(0)}\) for unlabeled RNAs and estimate
turnover kinetics from the ratio of this quantity to the remaining unlabeled RNA levels
after labeling:
$$\theta_{\text{NSS}} = \frac{\text{R(tl)}}{\text{R(0)}}$$
While I really like the idea of this strategy, it is not without some severe limitations.
For one, the major benefit of NR-seq, internally normalized estimation of turnover
kinetics, is out the window. Thus, read counts need to be normalized between
the relevant reference and label-fed sample pairs. In addition, the variance
patterns of this ratio are somewhat unfortunate. Its variance
is incredibly high for more stable RNAs, severely limiting the effective
dynamic range of this approach relative to steady-state analyses. I continue
to work to refine EZbakR's implementation of this approach, but for now I
urge caution in its use and interpretation. See my discussion of an alternative
approach for navigating non-steady-state data <a href="https://simonlabcode.github.io/bakR/articles/NSS.html#going-beyond-the-steady-state-assumption" class="external-link">here</a>.</p>
<p>As an aside, you may wonder how this strategy deals with dynamic regulation of
synthesis and degradation rate constants <em>during labeling</em>. To answer this,
you have to realize that the duration of metabolic labeling represents an
integration time over which the best we can do is assess average kinetics. Thus,
if rate constants are changing during the labeling, this strategy can still be
thought of as providing a an estimate of the time averaged synthesis and turnover
kinetics during the label time.</p>
<p>Eventually, I will get around to implementing pulse-chase support in <code>EstimateKinetics()</code>.
I haven't yet because I don't like pulse-chase experiments and think they are
way more popular than they should be for purely historical reasons. But lots
of people keep doing pulse-chase NR-seq so c'est la vie.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate data to analyze</span></span></span>
<span class="r-in"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="SimulateOneRep.html">SimulateOneRep</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create EZbakR input</span></span></span>
<span class="r-in"><span><span class="va">metadf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="st">"sampleA"</span>, tl <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="EZbakRData.html">EZbakRData</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">$</span><span class="va">cB</span>, <span class="va">metadf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate Fractions</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="EstimateFractions.html">EstimateFractions</a></span><span class="op">(</span><span class="va">ezbdo</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating mutation rates</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Summarizing data for feature(s) of interest</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Averaging out the nucleotide counts for improved efficiency</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating fractions</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing output</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate Kinetics</span></span></span>
<span class="r-in"><span><span class="va">ezbdo</span> <span class="op">&lt;-</span> <span class="fu">EstimateKinetics</span><span class="op">(</span><span class="va">ezbdo</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Vock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

